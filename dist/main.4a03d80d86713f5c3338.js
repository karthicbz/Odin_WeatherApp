(()=>{"use strict";const e=(()=>{const e=document.createElement("div");e.id="inputContainer";const t=document.createElement("input");t.type="text",t.className="city-input",t.name="city-input",e.appendChild(t);const n=document.createElement("button");return n.className="weather-search",n.textContent="Search",e.appendChild(n),e})(),t={weatherData:async function(e,t){try{const n=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&units=${t}&APPID=228a3f9fe276acdf8c030f707cddc96f`,{mode:"cors"});if(404!==n.status)return await n.json();alert("city not found")}catch(e){console.log(e)}}},n={hourlyWeatherData:async function(e,t){try{const n=await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${e}&units=${t}&appid=228a3f9fe276acdf8c030f707cddc96f`);if(404!==n.status)return await n.json();alert("city not found")}catch(e){console.log(e)}}},a=(e,t=null,n=null,a=null,r=null,c=null)=>"input"===e?l.formElementCreator(e,t,n,a):"img"!==e?l.creator(e,t,n,a):l.imageElementCreator(e,t,n,a,r,c),r=(e,t=null,n=null)=>{const r=document.createElement("div");return null!==t&&r.classList.add(t),null!==n&&r.setAttribute("id",`${n}`),e.forEach((e=>{const[t,n,l,c,o,i]=e;r.appendChild(a(t,n,l,c,o,i))})),r},l=(()=>{const e=(e,t,n,a)=>{const r=document.createElement(e);return null!==t&&r.classList.add(t),null!==n&&r.setAttribute("id",`${n}`),"input"!==e?"span"===e?null!==a&&(r.innerHTML=a):null!==a&&(r.textContent=a):r.type=a,r};return{creator:e,imageElementCreator:(t,n,a,r,l,c)=>{const o=e(t,n,a,r);return null!==c&&(o.alt=c),null!==l&&(o.src=l),o},formElementCreator:(t,n,a,r)=>e(t,n,a,r)}})(),c=(()=>{const e=document.createElement("div");e.id="weatherContainer";const t=r([["p","cityName"]],"weather-header"),n=r([["button","metric",null,"C"],["button","imperial",null,"F"]],"units");t.append(n);const l=document.createElement("div");l.className="weather-details";const c=document.createElement("img");c.className="weather-img",c.src="#",l.appendChild(c);const o=document.createElement("p");o.className="main-weather",l.appendChild(o);const i=document.createElement("div");i.className="other-details";const s=document.createElement("p");s.className="weather-text",i.appendChild(s);const u=r([["p","max-temp",null],["p","min-temp",null],["p","visibility",null],["p","humidity",null]],"other-weather-info"),d=a("div","hourly-weather");for(let e=0;e<40;e++){const t=r([["p","day"],["img","weather-img"],["p","min-max"],["p","desc"]],"hourly-weather-"+e);d.appendChild(t)}return e.appendChild(t),e.appendChild(l),e.appendChild(i),e.appendChild(u),e.appendChild(d),e})(),o=document.querySelector("#content");o.appendChild(e),o.appendChild(c);const i=document.querySelector(".city-input"),s=document.querySelector(".weather-search"),u=document.querySelector(".main-weather"),d=document.querySelector(".weather-img"),m=document.querySelector(".weather-header>.units"),p=document.querySelector(".cityName");let h={unit:"metric",symbol:"C"};s.addEventListener("click",(()=>{w(i.value,h.unit),f(i.value,h.unit)}));const y=(e,t)=>{const n=document.querySelectorAll(".other-weather-info>p"),[a,r,l,c]=Array.from(n);a.innerHTML=`Max: ${e.main.temp_max}<span class='units'>&#176;${t}</span>`,r.innerHTML=`Min: ${e.main.temp_min}<span class='units'>&#176;${t}</span>`,l.textContent=`Visibility: ${Math.floor(e.visibility/1e3)}km`,c.textContent=`Humidity: ${e.main.humidity}%`},w=(e,n)=>{t.weatherData(e,n).then((function(e){console.log(e),((e,t)=>{p.innerHTML=`${e.name}<span>, ${e.sys.country}</span>`,u.innerHTML=`${e.main.temp}<span class='units'>&#176;${t}</span>`,d.src=`http://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png`,document.querySelector(".weather-text").innerHTML=`Feels like ${e.main.feels_like}<span>&#176;${t}</span>. ${e.weather[0].description}`,y(e,t)})(e,h.symbol)})).catch((e=>{console.log(e)}))},f=(e,t)=>{n.hourlyWeatherData(e,t).then((function(e){console.log(e.list),C(e.list,h.symbol)})).catch((e=>{console.log(e)}))},C=(e,t)=>{document.querySelectorAll(".hourly-weather>div").forEach((n=>{let a=Number(n.className.slice(-1));const[r,l,c,o]=Array.from(n.childNodes),i=new Date(1e3*e[a].dt);r.textContent=i.toDateString().replace("2023",""),l.src=`http://openweathermap.org/img/wn/${e[a].weather[0].icon}.png`,c.innerHTML=`${e[a].main.temp}<span>&#176;${t}</span>`,o.textContent=e[a].weather[0].description}))};window.addEventListener("load",(()=>{w("london",h.unit),f("london",h.unit),document.querySelector(".units>.metric").classList.add("selected")})),m.addEventListener("click",(e=>{document.querySelectorAll(".units>button").forEach((e=>{e.classList.remove("selected")})),h.unit=e.target.className;let t=p.textContent.split(",");w(t[0],h.unit),f(t[0],h.unit),"metric"===e.target.className?h.symbol="C":h.symbol="F",e.target.classList.add("selected")}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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NEQsRUFBSzRCLEdBQWNWLFFBQVEsR0FBR0csV0FBVyxHQUN0RSxFQUdMbUIsT0FBTzVDLGlCQUFpQixRQUFRLEtBQzVCQyxFQUFrQixTQUFVSCxFQUFhakQsTUFDekNxRCxFQUF3QixTQUFVSixFQUFhakQsTUFDL0NkLFNBQVMwRCxjQUFjLGtCQUFrQnBCLFVBQVVDLElBQUksV0FBVyxJQUd0RXVCLEVBQU1HLGlCQUFpQixTQUFVNkMsSUFDN0I5RyxTQUFTdUUsaUJBQWlCLGlCQUFpQjlCLFNBQVFqQyxJQUMvQ0EsRUFBTzhCLFVBQVV5RSxPQUFPLFdBQVcsSUFFdkNoRCxFQUFhakQsS0FBT2dHLEVBQUVFLE9BQU8zRyxVQUM3QixJQUFJQyxFQUFPTyxFQUFTSixZQUFZd0csTUFBTSxLQUN0Qy9DLEVBQWtCNUQsRUFBSyxHQUFJeUQsRUFBYWpELE1BQ3hDcUQsRUFBd0I3RCxFQUFLLEdBQUl5RCxFQUFhakQsTUFDcEIsV0FBdkJnRyxFQUFFRSxPQUFPM0csVUFDUjBELEVBQWFDLE9BQVMsSUFFdEJELEVBQWFDLE9BQVMsSUFFMUI4QyxFQUFFRSxPQUFPMUUsVUFBVUMsSUFBSSxXQUFXLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWF0aGVyX2FwcC8uL3NyYy9zY3JpcHRzL2lucHV0Q29udGFpbmVyLmpzIiwid2VicGFjazovL3dlYXRoZXJfYXBwLy4vc3JjL3NjcmlwdHMvd2VhdGhlckRhdGEuanMiLCJ3ZWJwYWNrOi8vd2VhdGhlcl9hcHAvLi9zcmMvc2NyaXB0cy9lbGVtZW50X2NyZWF0b3IuanMiLCJ3ZWJwYWNrOi8vd2VhdGhlcl9hcHAvLi9zcmMvc2NyaXB0cy93ZWF0aGVyQ29udGFpbmVyLmpzIiwid2VicGFjazovL3dlYXRoZXJfYXBwLy4vc3JjL3NjcmlwdHMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaW5wdXRDb250YWluZXIgPSAoKCk9PntcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb250YWluZXIuaWQgPSAnaW5wdXRDb250YWluZXInO1xuXG4gICAgY29uc3QgaW5wdXRGaWVsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgaW5wdXRGaWVsZC50eXBlID0gJ3RleHQnO1xuICAgIGlucHV0RmllbGQuY2xhc3NOYW1lID0gJ2NpdHktaW5wdXQnO1xuICAgIGlucHV0RmllbGQubmFtZSA9ICdjaXR5LWlucHV0J1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dEZpZWxkKTtcblxuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIGJ1dHRvbi5jbGFzc05hbWUgPSAnd2VhdGhlci1zZWFyY2gnO1xuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9ICdTZWFyY2gnO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pO1xuXG4gICAgcmV0dXJuIGNvbnRhaW5lcjtcbn0pKCk7XG5cbmV4cG9ydCB7aW5wdXRDb250YWluZXJ9OyIsImNvbnN0IGdldFdlYXRoZXJEYXRhID0gKCgpPT57XG4gICAgYXN5bmMgZnVuY3Rpb24gd2VhdGhlckRhdGEoY2l0eU5hbWUsIHVuaXQpe1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5vcGVud2VhdGhlcm1hcC5vcmcvZGF0YS8yLjUvd2VhdGhlcj9xPSR7Y2l0eU5hbWV9JnVuaXRzPSR7dW5pdH0mQVBQSUQ9MjI4YTNmOWZlMjc2YWNkZjhjMDMwZjcwN2NkZGM5NmZgLCB7bW9kZTogJ2NvcnMnfSk7XG4gICAgICAgICAgICBpZihyZXNwb25zZS5zdGF0dXMgIT09IDQwNCl7XG4gICAgICAgICAgICAgICAgY29uc3QganNvbkRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGpzb25EYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICBhbGVydCgnY2l0eSBub3QgZm91bmQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaChlcnJvcil7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHt3ZWF0aGVyRGF0YX07XG59KSgpO1xuXG5jb25zdCBnZXRIb3VybHlXZWF0aGVyRGF0YSA9ICgoKT0+e1xuICAgIGFzeW5jIGZ1bmN0aW9uIGhvdXJseVdlYXRoZXJEYXRhKGNpdHlOYW1lLCB1bml0KXtcbiAgICAgICAgdHJ5e1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L2ZvcmVjYXN0P3E9JHtjaXR5TmFtZX0mdW5pdHM9JHt1bml0fSZhcHBpZD0yMjhhM2Y5ZmUyNzZhY2RmOGMwMzBmNzA3Y2RkYzk2ZmApO1xuICAgICAgICAgICAgaWYocmVzcG9uc2Uuc3RhdHVzICE9PSA0MDQpe1xuICAgICAgICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIHJldHVybiBqc29uRGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ2NpdHkgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2goZXJyb3Ipe1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7aG91cmx5V2VhdGhlckRhdGF9O1xufSkoKTtcblxuZXhwb3J0e2dldFdlYXRoZXJEYXRhLCBnZXRIb3VybHlXZWF0aGVyRGF0YX07IiwiY29uc3QgY3JlYXRlRWxlbWVudCA9ICh0YWdOYW1lLCBjbGFzc05hbWU9bnVsbCwgaWROYW1lPW51bGwsIHRleHQ9bnVsbCwgc3JjPW51bGwsIGFsdD1udWxsKT0+e1xuICAgIGlmKHRhZ05hbWUgPT09ICdpbnB1dCcpe1xuICAgICAgICByZXR1cm4gZWxlbWVudENyZWF0b3IuZm9ybUVsZW1lbnRDcmVhdG9yKHRhZ05hbWUsIGNsYXNzTmFtZSwgaWROYW1lLCB0ZXh0KTtcbiAgICB9ZWxzZSBpZih0YWdOYW1lICE9PSAnaW1nJyl7XG4gICAgICAgIHJldHVybiBlbGVtZW50Q3JlYXRvci5jcmVhdG9yKHRhZ05hbWUsIGNsYXNzTmFtZSwgaWROYW1lLCB0ZXh0KTtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRDcmVhdG9yLmltYWdlRWxlbWVudENyZWF0b3IodGFnTmFtZSwgY2xhc3NOYW1lLCBpZE5hbWUsIHRleHQsIHNyYywgYWx0KTtcbiAgICB9XG59XG5cbmNvbnN0IGRpdlBhY2tlciA9ICh2YWx1ZXMsIGNsYXNzTmFtZT1udWxsLCBpZE5hbWU9bnVsbCk9PntcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgaWYoY2xhc3NOYW1lICE9PSBudWxsKXtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgfVxuICAgIGlmKGlkTmFtZSAhPT0gbnVsbCl7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdpZCcsIGAke2lkTmFtZX1gKTtcbiAgICB9XG4gICAgdmFsdWVzLmZvckVhY2godmFsdWU9PntcbiAgICAgICAgY29uc3QgW3RhZ05hbWUsIGNsYXNzTmFtZSwgaWROYW1lLCB0ZXh0LCBzcmMsIGFsdF0gPSB2YWx1ZTtcbiAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KHRhZ05hbWUsIGNsYXNzTmFtZSwgaWROYW1lLCB0ZXh0LCBzcmMsIGFsdCkpO1xuICAgIH0pO1xuICAgIHJldHVybiBlbGVtZW50O1xufVxuXG5jb25zdCBlbGVtZW50Q3JlYXRvciA9ICgoKT0+e1xuICAgIGNvbnN0IGNyZWF0b3IgPSAodGFnTmFtZSwgY2xhc3NOYW1lLCBpZE5hbWUsIHRleHQpPT57XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xuICAgICAgICBpZihjbGFzc05hbWUgIT09IG51bGwpe1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYoaWROYW1lICE9PSBudWxsKXtcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdpZCcsIGAke2lkTmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgICBpZih0YWdOYW1lICE9PSAnaW5wdXQnKXtcbiAgICAgICAgICAgIGlmKHRhZ05hbWUgPT09ICdzcGFuJyl7XG4gICAgICAgICAgICAgICAgaWYodGV4dCAhPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBpZih0ZXh0ICE9PSBudWxsKXtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBlbGVtZW50LnR5cGUgPSB0ZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgIH1cblxuICAgIGNvbnN0IGltYWdlRWxlbWVudENyZWF0b3IgPSAodGFnTmFtZSwgY2xhc3NOYW1lLCBpZE5hbWUsIHRleHQsIHNyYywgYWx0KT0+e1xuICAgICAgICAvLyBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcbiAgICAgICAgLy8gaWYoYWx0ICE9PSBudWxsKXtcbiAgICAgICAgLy8gICAgIGVsZW1lbnQuYWx0ID0gYWx0O1xuICAgICAgICAvLyB9XG4gICAgICAgIC8vIGlmKHNyYyAhPT0gbnVsbCl7XG4gICAgICAgIC8vICAgICBlbGVtZW50LnNyYyA9IHNyYztcbiAgICAgICAgLy8gfVxuICAgICAgICAvLyByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGNyZWF0b3IodGFnTmFtZSwgY2xhc3NOYW1lLCBpZE5hbWUsIHRleHQpO1xuICAgICAgICBpZihhbHQgIT09IG51bGwpe1xuICAgICAgICAgICAgZWxlbWVudC5hbHQgPSBhbHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYoc3JjICE9PSBudWxsKXtcbiAgICAgICAgICAgIGVsZW1lbnQuc3JjID0gc3JjO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgIH1cblxuICAgIGNvbnN0IGZvcm1FbGVtZW50Q3JlYXRvciA9ICh0YWdOYW1lLCBjbGFzc05hbWUsIGlkTmFtZSwgdHlwZSk9PntcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGNyZWF0b3IodGFnTmFtZSwgY2xhc3NOYW1lLCBpZE5hbWUsIHR5cGUpO1xuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9XG5cbiAgICByZXR1cm4ge2NyZWF0b3IsIGltYWdlRWxlbWVudENyZWF0b3IsIGZvcm1FbGVtZW50Q3JlYXRvcn07XG59KSgpO1xuXG5leHBvcnQge2NyZWF0ZUVsZW1lbnQsIGRpdlBhY2tlcn07IiwiaW1wb3J0IHsgY3JlYXRlRWxlbWVudCwgZGl2UGFja2VyIH0gZnJvbSBcIi4vZWxlbWVudF9jcmVhdG9yXCI7XG5pbXBvcnQgeyBnZXRIb3VybHlXZWF0aGVyRGF0YSB9IGZyb20gXCIuL3dlYXRoZXJEYXRhXCI7XG5cbmNvbnN0IHdlYXRoZXJDb250YWluZXIgPSAoKCk9PntcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb250YWluZXIuaWQgPSAnd2VhdGhlckNvbnRhaW5lcic7XG5cblxuICAgIC8vIGNvbnN0IGNvdW50cnlEZXRhaWxzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgLy8gY291bnRyeURldGFpbHMuY2xhc3NOYW1lID0gJ2NvdW50cnktZGV0YWlscyc7XG5cbiAgICAvLyBjb25zdCBjaXR5TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAvLyBjaXR5TmFtZS5jbGFzc05hbWUgPSAnY2l0eU5hbWUnO1xuICAgIC8vIGNvdW50cnlEZXRhaWxzLmFwcGVuZENoaWxkKGNpdHlOYW1lKTtcbiAgICBjb25zdCB3ZWF0aGVySGVhZGVyID0gZGl2UGFja2VyKFtbJ3AnLCAnY2l0eU5hbWUnXV0sICd3ZWF0aGVyLWhlYWRlcicpO1xuICAgIGNvbnN0IHVuaXRUb2dnbGVyID0gZGl2UGFja2VyKFtbJ2J1dHRvbicsICdtZXRyaWMnLCBudWxsLCAnQyddLCBbJ2J1dHRvbicsICdpbXBlcmlhbCcsIG51bGwsICdGJ11dLCAndW5pdHMnKTtcbiAgICB3ZWF0aGVySGVhZGVyLmFwcGVuZCh1bml0VG9nZ2xlcik7XG5cbiAgICBjb25zdCB3ZWF0aGVyRGV0YWlscyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHdlYXRoZXJEZXRhaWxzLmNsYXNzTmFtZSA9ICd3ZWF0aGVyLWRldGFpbHMnO1xuXG4gICAgY29uc3Qgd2VhdGhlckltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgd2VhdGhlckltYWdlLmNsYXNzTmFtZSA9ICd3ZWF0aGVyLWltZyc7XG4gICAgd2VhdGhlckltYWdlLnNyYyA9ICcjJztcbiAgICB3ZWF0aGVyRGV0YWlscy5hcHBlbmRDaGlsZCh3ZWF0aGVySW1hZ2UpO1xuXG4gICAgY29uc3QgbWFpbldlYXRoZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgbWFpbldlYXRoZXIuY2xhc3NOYW1lID0gJ21haW4td2VhdGhlcic7XG4gICAgd2VhdGhlckRldGFpbHMuYXBwZW5kQ2hpbGQobWFpbldlYXRoZXIpO1xuXG4gICAgY29uc3Qgb3RoZXJXZWF0aGVyRGV0YWlscyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG90aGVyV2VhdGhlckRldGFpbHMuY2xhc3NOYW1lID0gJ290aGVyLWRldGFpbHMnO1xuXG4gICAgY29uc3Qgd2VhdGhlclRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgd2VhdGhlclRleHQuY2xhc3NOYW1lID0gJ3dlYXRoZXItdGV4dCc7XG4gICAgb3RoZXJXZWF0aGVyRGV0YWlscy5hcHBlbmRDaGlsZCh3ZWF0aGVyVGV4dCk7XG5cbiAgICBjb25zdCBvdGhlcldlYXRoZXJJbmZvID0gZGl2UGFja2VyKFtbJ3AnLCAnbWF4LXRlbXAnLCBudWxsXSwgWydwJywgJ21pbi10ZW1wJywgbnVsbF0sXG5bJ3AnLCAndmlzaWJpbGl0eScsIG51bGxdLCBbJ3AnLCAnaHVtaWRpdHknLCBudWxsXV0sICdvdGhlci13ZWF0aGVyLWluZm8nKTtcblxuICAgIGNvbnN0IGhvdXJseVdlYXRoZXJDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCAnaG91cmx5LXdlYXRoZXInKTtcbiAgICBmb3IobGV0IGk9MDsgaTw0MDsgaSsrKXtcbiAgICAgICAgY29uc3QgaG91cmx5V2VhdGhlciA9IGRpdlBhY2tlcihbWydwJywgJ2RheSddLCBbJ2ltZycsICd3ZWF0aGVyLWltZyddLCBbJ3AnLCAnbWluLW1heCddLCBbJ3AnLCAnZGVzYyddXSwgJ2hvdXJseS13ZWF0aGVyLScraSk7XG4gICAgICAgIGhvdXJseVdlYXRoZXJDb250YWluZXIuYXBwZW5kQ2hpbGQoaG91cmx5V2VhdGhlcik7XG4gICAgfVxuXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHdlYXRoZXJIZWFkZXIpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh3ZWF0aGVyRGV0YWlscyk7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG90aGVyV2VhdGhlckRldGFpbHMpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChvdGhlcldlYXRoZXJJbmZvKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaG91cmx5V2VhdGhlckNvbnRhaW5lcik7XG5cbiAgICByZXR1cm4gY29udGFpbmVyO1xufSkoKTtcblxuZXhwb3J0IHt3ZWF0aGVyQ29udGFpbmVyfTsiLCJpbXBvcnQgeyBpbnB1dENvbnRhaW5lciB9IGZyb20gXCIuL2lucHV0Q29udGFpbmVyXCI7XG5pbXBvcnQgeyBnZXRIb3VybHlXZWF0aGVyRGF0YSwgZ2V0V2VhdGhlckRhdGEgfSBmcm9tIFwiLi93ZWF0aGVyRGF0YVwiO1xuaW1wb3J0IHsgd2VhdGhlckNvbnRhaW5lciB9IGZyb20gXCIuL3dlYXRoZXJDb250YWluZXJcIjtcbmltcG9ydCAnLi4vc3R5bGVzL3N0eWxlLmNzcyc7XG5cbmNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY29udGVudCcpO1xuXG5jb250ZW50LmFwcGVuZENoaWxkKGlucHV0Q29udGFpbmVyKTtcbmNvbnRlbnQuYXBwZW5kQ2hpbGQod2VhdGhlckNvbnRhaW5lcik7XG5cbmNvbnN0IHNlYXJjaEZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNpdHktaW5wdXQnKTtcbmNvbnN0IHNlYXJjaEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53ZWF0aGVyLXNlYXJjaCcpO1xuY29uc3QgbWFpbldlYXRoZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbi13ZWF0aGVyJyk7XG5jb25zdCBtYWluV2VhdGhlckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndlYXRoZXItaW1nJyk7XG5jb25zdCB1bml0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53ZWF0aGVyLWhlYWRlcj4udW5pdHMnKTtcbmNvbnN0IGNpdHlOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNpdHlOYW1lJyk7XG5sZXQgc2VsZWN0ZWRVbml0ID0ge3VuaXQ6ICdtZXRyaWMnLCBzeW1ib2w6ICdDJ307XG5cbnNlYXJjaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XG4gICAgZ2V0V2VhdGhlckRldGFpbHMoc2VhcmNoRmllbGQudmFsdWUsIHNlbGVjdGVkVW5pdC51bml0KTtcbiAgICBnZXRIb3VybHlXZWF0aGVyRGV0YWlscyhzZWFyY2hGaWVsZC52YWx1ZSwgc2VsZWN0ZWRVbml0LnVuaXQpO1xufSlcblxuY29uc3QgZGlzcGxheVdlYXRoZXJEZXRhaWxzID0gKGRhdGEsIHVuaXQpPT57XG4gICAgY2l0eU5hbWUuaW5uZXJIVE1MID0gYCR7ZGF0YS5uYW1lfTxzcGFuPiwgJHtkYXRhLnN5cy5jb3VudHJ5fTwvc3Bhbj5gO1xuICAgIG1haW5XZWF0aGVyLmlubmVySFRNTCA9IGAke2RhdGEubWFpbi50ZW1wfTxzcGFuIGNsYXNzPSd1bml0cyc+JiMxNzY7JHt1bml0fTwvc3Bhbj5gO1xuICAgIG1haW5XZWF0aGVySW1hZ2Uuc3JjID0gYGh0dHA6Ly9vcGVud2VhdGhlcm1hcC5vcmcvaW1nL3duLyR7ZGF0YS53ZWF0aGVyWzBdLmljb259QDJ4LnBuZ2A7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndlYXRoZXItdGV4dCcpLmlubmVySFRNTCA9IGBGZWVscyBsaWtlICR7ZGF0YS5tYWluLmZlZWxzX2xpa2V9PHNwYW4+JiMxNzY7JHt1bml0fTwvc3Bhbj4uICR7ZGF0YS53ZWF0aGVyWzBdLmRlc2NyaXB0aW9ufWA7XG4gICAgdXBkYXRlT3RoZXJJbmZvKGRhdGEsIHVuaXQpO1xufVxuXG5jb25zdCB1cGRhdGVPdGhlckluZm8gPSAoZGF0YSwgdW5pdCk9PntcbiAgICBjb25zdCBvdGhlckluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub3RoZXItd2VhdGhlci1pbmZvPnAnKTtcbiAgICBjb25zdCBbbWF4VGVtcCwgbWluVGVtcCwgdmlzaWJpbGl0eSwgaHVtaWRpdHldID0gQXJyYXkuZnJvbShvdGhlckluZm8pO1xuICAgIG1heFRlbXAuaW5uZXJIVE1MID0gYE1heDogJHtkYXRhLm1haW4udGVtcF9tYXh9PHNwYW4gY2xhc3M9J3VuaXRzJz4mIzE3Njske3VuaXR9PC9zcGFuPmA7XG4gICAgbWluVGVtcC5pbm5lckhUTUwgPSBgTWluOiAke2RhdGEubWFpbi50ZW1wX21pbn08c3BhbiBjbGFzcz0ndW5pdHMnPiYjMTc2OyR7dW5pdH08L3NwYW4+YDtcbiAgICB2aXNpYmlsaXR5LnRleHRDb250ZW50ID0gYFZpc2liaWxpdHk6ICR7TWF0aC5mbG9vcihkYXRhLnZpc2liaWxpdHkvMTAwMCl9a21gO1xuICAgIGh1bWlkaXR5LnRleHRDb250ZW50ID0gYEh1bWlkaXR5OiAke2RhdGEubWFpbi5odW1pZGl0eX0lYDtcbn1cblxuY29uc3QgZ2V0V2VhdGhlckRldGFpbHMgPSAodmFsdWUsIHVuaXQpPT57XG4gICAgZ2V0V2VhdGhlckRhdGEud2VhdGhlckRhdGEodmFsdWUsIHVuaXQpXG4gICAgLnRoZW4oZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICBkaXNwbGF5V2VhdGhlckRldGFpbHMoZGF0YSwgc2VsZWN0ZWRVbml0LnN5bWJvbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyPT57XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbn1cblxuY29uc3QgZ2V0SG91cmx5V2VhdGhlckRldGFpbHMgPSAodmFsdWUsIHVuaXQpPT57XG4gICAgZ2V0SG91cmx5V2VhdGhlckRhdGEuaG91cmx5V2VhdGhlckRhdGEodmFsdWUsIHVuaXQpXG4gICAgLnRoZW4oZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEubGlzdCk7XG4gICAgICAgIGRpc3BsYXlIb3VybHlXZWF0aGVyRGV0YWlscyhkYXRhLmxpc3QsIHNlbGVjdGVkVW5pdC5zeW1ib2wpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVycj0+e1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG59XG5cbmNvbnN0IGRpc3BsYXlIb3VybHlXZWF0aGVyRGV0YWlscyA9IChkYXRhLCB1bml0KT0+e1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ob3VybHktd2VhdGhlcj5kaXYnKS5mb3JFYWNoKGRpdj0+e1xuICAgICAgICBsZXQgY3VycmVudEFycmF5ID0gTnVtYmVyKGRpdi5jbGFzc05hbWUuc2xpY2UoLTEpKTtcbiAgICAgICAgY29uc3QgW2RheSwgaW1hZ2UsIHdlYXRoZXIsIHdlYXRoZXJEZXNjXSA9IEFycmF5LmZyb20oZGl2LmNoaWxkTm9kZXMpO1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0YVtjdXJyZW50QXJyYXldLmR0ICogMTAwMCk7XG4gICAgICAgIGRheS50ZXh0Q29udGVudCA9IGRhdGUudG9EYXRlU3RyaW5nKCkucmVwbGFjZSgnMjAyMycsICcnKTtcblxuICAgICAgICBpbWFnZS5zcmMgPSBgaHR0cDovL29wZW53ZWF0aGVybWFwLm9yZy9pbWcvd24vJHtkYXRhW2N1cnJlbnRBcnJheV0ud2VhdGhlclswXS5pY29ufS5wbmdgO1xuXG4gICAgICAgIHdlYXRoZXIuaW5uZXJIVE1MID0gYCR7ZGF0YVtjdXJyZW50QXJyYXldLm1haW4udGVtcH08c3Bhbj4mIzE3Njske3VuaXR9PC9zcGFuPmA7XG5cbiAgICAgICAgd2VhdGhlckRlc2MudGV4dENvbnRlbnQgPSBkYXRhW2N1cnJlbnRBcnJheV0ud2VhdGhlclswXS5kZXNjcmlwdGlvbjtcbiAgICB9KVxufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpPT57XG4gICAgZ2V0V2VhdGhlckRldGFpbHMoJ2xvbmRvbicsIHNlbGVjdGVkVW5pdC51bml0KTtcbiAgICBnZXRIb3VybHlXZWF0aGVyRGV0YWlscygnbG9uZG9uJywgc2VsZWN0ZWRVbml0LnVuaXQpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy51bml0cz4ubWV0cmljJykuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbn0pXG5cbnVuaXRzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT57XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnVuaXRzPmJ1dHRvbicpLmZvckVhY2goYnV0dG9uPT57XG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpO1xuICAgIH0pO1xuICAgIHNlbGVjdGVkVW5pdC51bml0ID0gZS50YXJnZXQuY2xhc3NOYW1lO1xuICAgIGxldCBuYW1lID0gY2l0eU5hbWUudGV4dENvbnRlbnQuc3BsaXQoJywnKTtcbiAgICBnZXRXZWF0aGVyRGV0YWlscyhuYW1lWzBdLCBzZWxlY3RlZFVuaXQudW5pdCk7XG4gICAgZ2V0SG91cmx5V2VhdGhlckRldGFpbHMobmFtZVswXSwgc2VsZWN0ZWRVbml0LnVuaXQpO1xuICAgIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PT0gJ21ldHJpYycpe1xuICAgICAgICBzZWxlY3RlZFVuaXQuc3ltYm9sID0gJ0MnO1xuICAgIH1lbHNle1xuICAgICAgICBzZWxlY3RlZFVuaXQuc3ltYm9sID0gJ0YnO1xuICAgIH1cbiAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xufSlcbiJdLCJuYW1lcyI6WyJpbnB1dENvbnRhaW5lciIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiaW5wdXRGaWVsZCIsInR5cGUiLCJjbGFzc05hbWUiLCJuYW1lIiwiYXBwZW5kQ2hpbGQiLCJidXR0b24iLCJ0ZXh0Q29udGVudCIsImdldFdlYXRoZXJEYXRhIiwid2VhdGhlckRhdGEiLCJhc3luYyIsImNpdHlOYW1lIiwidW5pdCIsInJlc3BvbnNlIiwiZmV0Y2giLCJtb2RlIiwic3RhdHVzIiwianNvbiIsImFsZXJ0IiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZ2V0SG91cmx5V2VhdGhlckRhdGEiLCJob3VybHlXZWF0aGVyRGF0YSIsInRhZ05hbWUiLCJpZE5hbWUiLCJ0ZXh0Iiwic3JjIiwiYWx0IiwiZWxlbWVudENyZWF0b3IiLCJmb3JtRWxlbWVudENyZWF0b3IiLCJjcmVhdG9yIiwiaW1hZ2VFbGVtZW50Q3JlYXRvciIsImRpdlBhY2tlciIsInZhbHVlcyIsImVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJmb3JFYWNoIiwidmFsdWUiLCJpbm5lckhUTUwiLCJ3ZWF0aGVyQ29udGFpbmVyIiwid2VhdGhlckhlYWRlciIsInVuaXRUb2dnbGVyIiwiYXBwZW5kIiwid2VhdGhlckRldGFpbHMiLCJ3ZWF0aGVySW1hZ2UiLCJtYWluV2VhdGhlciIsIm90aGVyV2VhdGhlckRldGFpbHMiLCJ3ZWF0aGVyVGV4dCIsIm90aGVyV2VhdGhlckluZm8iLCJob3VybHlXZWF0aGVyQ29udGFpbmVyIiwiaSIsImhvdXJseVdlYXRoZXIiLCJjb250ZW50IiwicXVlcnlTZWxlY3RvciIsInNlYXJjaEZpZWxkIiwic2VhcmNoQnV0dG9uIiwibWFpbldlYXRoZXJJbWFnZSIsInVuaXRzIiwic2VsZWN0ZWRVbml0Iiwic3ltYm9sIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdldFdlYXRoZXJEZXRhaWxzIiwiZ2V0SG91cmx5V2VhdGhlckRldGFpbHMiLCJ1cGRhdGVPdGhlckluZm8iLCJkYXRhIiwib3RoZXJJbmZvIiwicXVlcnlTZWxlY3RvckFsbCIsIm1heFRlbXAiLCJtaW5UZW1wIiwidmlzaWJpbGl0eSIsImh1bWlkaXR5IiwiQXJyYXkiLCJmcm9tIiwibWFpbiIsInRlbXBfbWF4IiwidGVtcF9taW4iLCJNYXRoIiwiZmxvb3IiLCJ0aGVuIiwic3lzIiwiY291bnRyeSIsInRlbXAiLCJ3ZWF0aGVyIiwiaWNvbiIsImZlZWxzX2xpa2UiLCJkZXNjcmlwdGlvbiIsImRpc3BsYXlXZWF0aGVyRGV0YWlscyIsImNhdGNoIiwiZXJyIiwibGlzdCIsImRpc3BsYXlIb3VybHlXZWF0aGVyRGV0YWlscyIsImRpdiIsImN1cnJlbnRBcnJheSIsIk51bWJlciIsInNsaWNlIiwiZGF5IiwiaW1hZ2UiLCJ3ZWF0aGVyRGVzYyIsImNoaWxkTm9kZXMiLCJkYXRlIiwiRGF0ZSIsImR0IiwidG9EYXRlU3RyaW5nIiwicmVwbGFjZSIsIndpbmRvdyIsImUiLCJyZW1vdmUiLCJ0YXJnZXQiLCJzcGxpdCJdLCJzb3VyY2VSb290IjoiIn0=